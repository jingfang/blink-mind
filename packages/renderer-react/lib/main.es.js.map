{"version":3,"file":"main.es.js","sources":["../src/components/common/base-widget.tsx","../src/components/common/drag-scroll-widget.tsx","../src/components/common/save-ref.tsx","../src/components/common/styled.tsx","../src/utils/icon.tsx","../src/utils/keys.ts","../src/utils/events.ts","../src/utils/index.ts","../src/plugins/react/components/topic-drop-effect.tsx","../src/plugins/drag-and-drop.tsx","../src/plugins/event.ts","../src/plugins/hotkey.ts","../src/plugins/layout.tsx","../src/plugins/operation.ts","../src/plugins/react/components/editor-root-breadcrumbs.tsx","../src/plugins/react/components/mind-drag-scroll-widget.tsx","../src/plugins/react/components/modals.tsx","../src/plugins/react/components/root-sublinks.tsx","../src/plugins/react/components/root-widget.tsx","../src/plugins/react/components/style-editor/components.tsx","../src/plugins/react/components/style-editor/border-style-editor.tsx","../src/plugins/react/components/style-editor/clear-all-custom-style.tsx","../src/plugins/react/components/style-editor/link-style-editor.tsx","../src/plugins/react/components/style-editor/text-style-editor.tsx","../src/plugins/react/components/style-editor/style-editor.tsx","../src/plugins/react/components/topic-collapse-icon.tsx","../src/plugins/react/components/topic-content.tsx","../src/plugins/react/components/topic-content-widget.tsx","../src/plugins/react/components/topic-context-menu.tsx","../src/plugins/react/components/topic-desc.tsx","../src/plugins/react/components/topic-highlight.tsx","../src/plugins/react/components/topic-sub-links.tsx","../src/plugins/react/components/topic-widget.tsx","../src/plugins/react/components/view-port-util/view-port-viewer.tsx","../src/plugins/react/context-menus.tsx","../src/plugins/react/drawer.tsx","../src/plugins/react/theme.tsx","../src/plugins/react/rendering.tsx","../src/plugins/react/utils.tsx","../src/plugins/react/index.ts","../src/plugins/style.ts","../src/plugins/index.ts","../src/components/diagram.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { BaseProps } from './base-props';\n\nexport class BaseWidget<\n  P extends BaseProps = BaseProps,\n  S = any\n> extends React.PureComponent<P, S> {\n  constructor(props: P) {\n    super(props);\n  }\n\n  operation(opType: string, arg: any) {\n    this.props.controller.run('operation', {\n      opType,\n      ...arg\n    });\n  }\n\n  run(name: string, arg: any) {\n    this.props.controller.run(name, arg);\n  }\n\n  get topic() {\n    return this.props.model.getTopic(this.props.topicKey);\n  }\n}\n","import * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\n\nimport debug from 'debug';\nconst log = debug('node:drag-scroll-widget');\n\nconst DragScrollView = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n`;\n\nconst DragScrollContent = styled.div`\n  position: relative;\n  width: max-content;\n`;\n\nconst useWindowListener = false;\n\ninterface DragScrollWidgetProps {\n  mouseKey?: 'left' | 'right';\n  needKeyPressed?: boolean;\n  canDragFunc?: () => Boolean;\n  enableMouseWheel: boolean;\n  zoomFactor: number;\n  children: (\n    setViewBoxScroll: (left: number, top: number) => void,\n    setViewBoxScrollDelta: (left: number, top: number) => void\n  ) => React.ReactNode;\n}\n\nexport class DragScrollWidget extends React.Component<\n  DragScrollWidgetProps,\n  any\n> {\n  constructor(props: DragScrollWidgetProps) {\n    super(props);\n    this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n  }\n\n  static defaultProps = {\n    mouseKey: 'left',\n    needKeyPressed: false\n  };\n\n  contentResizeCallback = (\n    entries: ResizeObserverEntry[],\n    observer: ResizeObserver\n  ) => {\n    if (this.oldContentRect) {\n      const widgetStyle = {\n        width: this.content.clientWidth + this.viewBox.clientWidth * 2,\n        height: this.content.clientHeight + this.viewBox.clientHeight * 2\n      };\n      this.bigView.style.width = widgetStyle.width + 'px';\n      this.bigView.style.height = widgetStyle.height + 'px';\n    }\n    this.oldContentRect = entries[0].contentRect;\n  };\n\n  contentResizeObserver = new ResizeObserver(this.contentResizeCallback);\n  // oldScroll: { left: number; top: number };\n  oldContentRect: any;\n  content: HTMLElement;\n  contentRef = ref => {\n    if (ref) {\n      this.content = ref;\n      this.contentResizeObserver.observe(this.content);\n    }\n  };\n\n  viewBox: HTMLElement;\n  viewBoxRef = ref => {\n    if (ref) {\n      this.viewBox = ref;\n      if (!this.props.enableMouseWheel) {\n        log('addEventListener onwheel');\n        this.viewBox.addEventListener(\n          'wheel',\n          function(e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          },\n          {\n            passive: false\n          }\n        );\n      }\n      this.setViewBoxScroll(\n        this.viewBox.clientWidth,\n        this.viewBox.clientHeight\n      );\n    }\n  };\n\n  bigView: HTMLElement;\n  bigViewRef = ref => {\n    if (ref) {\n      this.bigView = ref;\n    }\n  };\n\n  setWidgetStyle = () => {\n    if (this.content && this.viewBox && this.bigView) {\n      this.bigView.style.width =\n        (this.content.clientWidth + this.viewBox.clientWidth) * 2 + 'px';\n      this.bigView.style.height =\n        (this.content.clientHeight + this.viewBox.clientHeight) * 2 + 'px';\n\n      this.content.style.left = this.viewBox.clientWidth + 'px';\n      this.content.style.top = this.viewBox.clientHeight + 'px';\n    }\n  };\n\n  setViewBoxScroll = (left: number, top: number) => {\n    log(`setViewBoxScroll ${left} ${top}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft = left;\n      this.viewBox.scrollTop = top;\n    }\n  };\n\n  setViewBoxScrollDelta = (deltaLeft: number, deltaTop: number) => {\n    log(`setViewBoxScrollDelta ${deltaLeft} ${deltaTop}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft += deltaLeft;\n      this.viewBox.scrollTop += deltaTop;\n    }\n  };\n\n  onMouseDown = e => {\n    // log('Drag Scroll onMouseDown');\n    // log(e.nativeEvent.target);\n\n    // mouseKey 表示鼠标按下那个键才可以进行拖动，左键或者右键\n    // needKeyPressed 为了支持是否需要按下ctrl键，才可以进行拖动\n    // canDragFunc是一个函数，它是为了支持使用者以传入函数的方式，这个函数的返回值表示当前的内容是否可以被拖拽而移动\n    const { mouseKey, needKeyPressed, canDragFunc } = this.props;\n    if (canDragFunc && !canDragFunc()) return;\n    if (\n      (e.button === 0 && mouseKey === 'left') ||\n      (e.button === 2 && mouseKey === 'right')\n    ) {\n      if (needKeyPressed) {\n        if (!e.ctrlKey) return;\n      }\n      this._lastCoordX = this.viewBox.scrollLeft + e.nativeEvent.clientX;\n      this._lastCoordY = this.viewBox.scrollTop + e.nativeEvent.clientY;\n\n      const ele = useWindowListener ? window : this.viewBox;\n      ele.addEventListener('mousemove', this.onMouseMove);\n      ele.addEventListener('mouseup', this.onMouseUp);\n    }\n  };\n\n  onMouseUp = e => {\n    const ele = useWindowListener ? window : this.viewBox;\n    ele.removeEventListener('mousemove', this.onMouseMove);\n    ele.removeEventListener('mouseup', this.onMouseUp);\n  };\n\n  // _lastCoordX和_lastCorrdY 是为了在拖动过程中 计算 viewBox的scrollLeft和scrollTop值用到\n  // _lastCoordX和_lastCorrdY 记录下拖动开始时刻viewBox的scroll值和鼠标位置值\n  _lastCoordX: number;\n  _lastCoordY: number;\n\n  onMouseMove = (e: MouseEvent) => {\n    this.viewBox.scrollLeft = this._lastCoordX - e.clientX;\n    this.viewBox.scrollTop = this._lastCoordY - e.clientY;\n    // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n  };\n\n  handleContextMenu = e => {\n    e.preventDefault();\n  };\n\n  componentDidMount(): void {\n    this.setWidgetStyle();\n    document.addEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  componentWillUnmount(): void {\n    document.removeEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  setZoomFactor(zoomFactor) {\n    this.bigView.style.transform = `scale(${zoomFactor})`;\n    this.bigView.style.transformOrigin = '50% 50%';\n  }\n\n  render() {\n    const style = {\n      ...this.state.widgetStyle\n      // zoom:this.props.zoomFactor,\n      // transform: `scale(${this.props.zoomFactor})`,\n      // transformOrigin: '50% 50%'\n    };\n    return (\n      <DragScrollView ref={this.viewBoxRef} onMouseDown={this.onMouseDown}>\n        <div style={style} ref={this.bigViewRef}>\n          <DragScrollContent\n            ref={this.contentRef}\n            style={this.state.contentStyle}\n          >\n            {this.props.children(\n              this.setViewBoxScroll,\n              this.setViewBoxScrollDelta\n            )}\n          </DragScrollContent>\n        </div>\n      </DragScrollView>\n    );\n  }\n}\n","import * as React from 'react';\n\ninterface SaveRefProps {\n  children: (\n    saveRef: Function,\n    getRef: Function,\n    registerRefListener: Function\n  ) => React.ReactNode;\n}\n\ntype RefListener = (name: string, ref: HTMLElement) => void;\n\nexport class SaveRef extends React.Component<SaveRefProps> {\n  getRef = name => {\n    return this[name];\n  };\n\n  saveRef = name => {\n    return node => {\n      if (node) {\n        this[name] = node;\n        this.fireListener(name, node);\n      }\n    };\n  };\n\n  observers: Map<string, [RefListener]> = new Map();\n\n  fireListener = (name: string, ref: HTMLElement) => {\n    if (this.observers.has(name)) {\n      const listeners = this.observers.get(name);\n      for (const listener of listeners) {\n        listener(name, ref);\n      }\n    }\n  };\n\n  registerRefListener = (name, listener: RefListener) => {\n    if (!this.observers.has(name)) {\n      this.observers.set(name, [listener]);\n    } else {\n      this.observers.get(name).push(listener);\n    }\n  };\n\n  render() {\n    return this.props.children(\n      this.saveRef,\n      this.getRef,\n      this.registerRefListener.bind(this)\n    );\n  }\n}\n","import styled from 'styled-components';\n\nexport const Flex = styled.div`\n  display: flex;\n  align-items: ${props => props.alignItems};\n`;\n\nexport const Margin = styled.div`\n  margin: ${props => props.margin};\n`;\n\nexport const ShowMenuIcon = styled.a`\n  font-size: 20px !important;\n`;\n\nexport const IconBg = styled.div`\n  padding: 5px;\n  cursor: pointer;\n`;\n\nexport const Btn = styled.div`\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n  &:focus {\n    outline: none;\n  }\n`\n\nexport const CloseIcon = styled(Btn)`\n  position: absolute;\n  right: 5px;\n  top: 5px;\n`;\n\nexport const Title = styled.div`\n  height: 16px;\n`;\n\nexport const TopicBlockIcon = styled.span`\n  margin: 0px 10px;\n`;\n","import * as React from 'react';\nexport const IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash'\n};\n\nexport function iconClassName(name) {\n  return `icon iconfont bm-${name}`;\n}\n\nexport function Icon(iconName) {\n  return <span className={iconClassName(iconName)} />;\n}\n","export function contentRefKey(key) {\n  return `content-${key}`;\n}\n\nexport function topicWidgetRefKey(key) {\n  return `topic-widget-${key}`;\n}\n\nexport function topicRefKey(key) {\n  return `topic-${key}`;\n}\n\nexport function linksRefKey(key) {\n  return `links-${key}`;\n}\n\nexport function linksSvgRefKey(key) {\n  return `links-svg-${key}`;\n}\n\nexport function collapseRefKey(key) {\n  return `collapse-${key}`;\n}\n\nexport const RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nexport const EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\n","export const cancelEvent = e => {\n  e.stopPropagation();\n};\n","import { KeyType } from '@blink-mind/core';\n\nexport function getLinkKey(fromKey: KeyType, toKey: KeyType) {\n  return `link-${fromKey}-${toKey}`;\n}\n\nexport type Point = {\n  x: number;\n  y: number;\n};\n\nexport function centerY(rect: ClientRect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nexport function centerX(rect: ClientRect) {\n  return (rect.left + rect.right) / 2;\n}\n\nexport function centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nexport function centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nexport function center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\nexport function getRelativeRect(\n  el: HTMLElement,\n  rel: HTMLElement,\n  scale: number = 1\n) {\n  const rect = el.getBoundingClientRect();\n  const relRect = rel.getBoundingClientRect();\n\n  const relCenter = center(relRect);\n  const elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  const width = rect.width / scale;\n  const height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width,\n    height\n  };\n}\n\nexport function getRelativeVector(el: HTMLElement, rel: HTMLElement) {\n  const rect = el.getBoundingClientRect();\n  const relRect = rel.getBoundingClientRect();\n  const relCenter = center(relRect);\n  const elCenter = center(rect);\n  return [(elCenter[0]-relCenter[0]),(elCenter[1]-relCenter[1])];\n}\n\nexport * from './icon';\nexport * from './keys';\nexport * from './events';\n","import debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  contentRefKey,\n  getRelativeRect,\n  RefKey\n} from '../../../utils';\nconst log = debug('node:topic-drop-effect');\n\nconst DropEffectSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicDropEffect extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const props = this.props;\n    const { getRef, model, zoomFactor, controller } = this.props;\n    const targetProps = controller.run('getDragTargetProps', props);\n    const { key, dropDir } = targetProps;\n    log('layout', dropDir);\n\n    if (key === null) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    let dropAreaRefKey;\n    if (dropDir === 'in') {\n      dropAreaRefKey = contentRefKey(key);\n    } else {\n      dropAreaRefKey = `dropArea-${dropDir}-${key}`;\n    }\n    const content = getRef(dropAreaRefKey);\n    const svg = getRef('svg-drop-effect');\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n\n    this.setState({\n      content: (\n        <g>\n          <rect\n            x={x}\n            y={y}\n            width={width}\n            height={height}\n            fill=\"none\"\n            stroke={model.config.theme.highlightColor}\n            strokeDasharray=\"5,5\"\n            strokeWidth={2}\n          />\n        </g>\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <DropEffectSvg ref={saveRef('svg-drop-effect')}>\n        {this.state.content}\n      </DropEffectSvg>\n    );\n  }\n}\n","import {\n  FocusMode,\n  getRelationship,\n  OpType,\n  TopicRelationship\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport {contentRefKey, RefKey} from '../utils';\nimport { TopicDropEffect } from './react/components/topic-drop-effect';\nconst log = debug('plugin:drag-and-drop');\nconst DropArea = styled.div`\n  height: ${props => `${props.height}px`};\n  width: 100%;\n  margin: 5px 0px;\n`;\n\nexport function DragAndDrop() {\n  let dragTargetKey: KeyType = null;\n  let dragTargetDir: string = null;\n\n  return {\n    renderTopicDropArea(props) {\n      const { topicKey, dropDir, saveRef, controller, model } = props;\n      const onDragEnter = ev => {\n        log('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', { ...props, ev, dropDir });\n      };\n      const onDragLeave = ev => {\n        log('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', { ...props, ev, dropDir });\n      };\n      const onDragOver = ev => {\n        ev.preventDefault();\n      };\n      const onDrop = ev => {\n        log('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', { ...props, ev, dropDir });\n      };\n      const eventHandlers = {\n        onDragEnter,\n        onDragLeave,\n        onDragOver,\n        onDrop\n      };\n      return (\n        <DropArea\n          height={model.config.theme.marginV / 2}\n          ref={saveRef(`dropArea-${dropDir}-${topicKey}`)}\n          {...eventHandlers}\n        />\n      );\n    },\n\n    renderDragAndDropEffect(props) {\n      log('renderDragAndDropEffect');\n      const { saveRef } = props;\n      return (\n        <TopicDropEffect\n          ref={saveRef(RefKey.DROP_EFFECT_KEY)}\n          {...props}\n        ></TopicDropEffect>\n      );\n    },\n\n    getDragTargetProps(props) {\n      return {\n        key: dragTargetKey,\n        dropDir: dragTargetDir\n      };\n    },\n\n    handleTopicDragStart(props) {\n      const { controller, ev } = props;\n      ev.stopPropagation();\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      });\n    },\n\n    canDrop(props) {\n      const { srcKey, dstKey, model, dropDir } = props;\n      if (\n        srcKey === model.editorRootTopicKey ||\n        srcKey === dstKey ||\n        getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR\n      )\n        return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n\n      const srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n\n    handleTopicDragEnter(props) {\n      const { dropDir, topicKey, controller, model, ev } = props;\n      log('handleTopicDragEnter:', topicKey, dropDir);\n      const canDrop = controller.run('canDrop', {\n        ...props,\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      if (canDrop) {\n        dragTargetKey = topicKey;\n        dragTargetDir = dropDir;\n        controller.change(model);\n      }\n    },\n\n    handleTopicDragLeave(props) {\n      const { controller, model, topicKey, dropDir, getRef, ev } = props;\n      const relatedTarget = ev.nativeEvent.relatedTarget;\n      log('handleTopicDragLeave:', topicKey, dropDir);\n      const content = getRef(contentRefKey(topicKey));\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n      dragTargetKey = null;\n      dragTargetDir = null;\n      controller.change(model);\n    },\n\n    handleTopicDrop(props) {\n      log('handleTopicDrop');\n      const { controller, topicKey, model } = props;\n      props = { ...props, srcKey: model.focusKey, dstKey: topicKey };\n\n      dragTargetKey = null;\n      dragTargetDir = null;\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', {\n          ...props,\n          opType: OpType.DRAG_AND_DROP\n        });\n      }\n    }\n  };\n}\n","import { FocusMode, OpType } from '@blink-mind/core';\n\nimport debug from 'debug';\n\nconst log = debug('plugin:event');\n\nexport function EventPlugin() {\n  const eventListeners = {};\n  return {\n    handleTopicClick(props) {\n      log('handleTopicClick');\n      const { controller, model, topicKey } = props;\n      log(model.zoomFactor);\n      //TODO\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (\n        model.focusKey === topicKey &&\n        (model.focusMode === FocusMode.EDITING_CONTENT)\n      )\n        return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      });\n    },\n\n    handleTopicDoubleClick(props) {\n      const { controller, model } = props;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      });\n    },\n\n    handleTopicContextMenu(props) {\n      const { controller } = props;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      });\n    },\n\n    handleActiveModalClose(props) {\n      const { controller } = props;\n      const activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n      if (activeModalProps.name === 'edit-desc') {\n        return function() {\n          controller.run('operation', {\n            ...props,\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          });\n        };\n      }\n    },\n\n    addEventListener(props) {\n      const { key, listener, once, controller } = props;\n      if (!eventListeners[key]) eventListeners[key] = [];\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key,\n          listener\n        });\n      }\n    },\n\n    removeEventListener(props) {\n      const { key, listener, controller } = props;\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(fn => {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n\n    fireEvent(props) {\n      const { key } = props;\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(fn => fn());\n      }\n    }\n  };\n}\n","import { OpType } from '@blink-mind/core';\n\nexport interface HotKeyConfig {\n  combo: string;\n  onKeyDown: Function;\n}\n\nexport const HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction op(opType: string, props) {\n  const { topicKey, model, controller } = props;\n  if (topicKey === undefined) {\n    props = { ...props, topicKey: model.focusKey };\n  }\n  controller.run('operation', { ...props, opType });\n}\n\nexport function HotKeyPlugin() {\n  return {\n    customizeHotKeys(props) {\n      const handleKeyDown = opType => e => {\n        // log('HotKeyPlugin', opType);\n        op(opType, props);\n      };\n      const hotKeyMap = new Map<string, HotKeyConfig>([\n        [\n          HotKeyName.ADD_CHILD,\n          {\n            label: 'add child',\n            combo: 'tab',\n            onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n          }\n        ],\n        [\n          HotKeyName.ADD_SIBLING,\n          {\n            label: 'add sibling',\n            combo: 'enter',\n            onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n          }\n        ],\n        [\n          HotKeyName.DELETE_TOPIC,\n          {\n            label: 'delete topic',\n            combo: 'backspace',\n            onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n          }\n        ],\n        [\n          HotKeyName.EDIT_CONTENT,\n          {\n            label: 'edit content',\n            combo: 'space',\n            onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n          }\n        ],\n        [\n          HotKeyName.EDIT_NOTES,\n          {\n            label: 'edit notes',\n            combo: 'alt + d',\n            onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n          }\n        ],\n        [\n          HotKeyName.SET_EDITOR_ROOT,\n          {\n            label: 'set editor root',\n            combo: 'alt + shift + f',\n            onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n          }\n        ]\n      ]);\n      return hotKeyMap;\n    }\n  };\n}\n","import {\n  DiagramLayoutType,\n  KeyType,\n  Model,\n  ModelModifier,\n  Topic\n} from '@blink-mind/core';\nimport * as React from 'react';\nimport {\n  getRelativeRect, getRelativeVector,\n  linksRefKey,\n  RefKey,\n  topicWidgetRefKey\n} from '../utils';\n\nexport type GetPartTopicsArg = {\n  layout: DiagramLayoutType;\n  model: Model;\n  topicKey: KeyType;\n};\nexport interface GetPartTopicsRes {\n  [part: number]: KeyType[];\n}\n\nexport function LayoutPlugin() {\n  const _zoomFactor = 1;\n  return {\n    getPartTopics({\n      layout,\n      model,\n      topicKey\n    }: GetPartTopicsArg): GetPartTopicsRes {\n      const topic = model.getTopic(topicKey);\n      const subTopicCount = topic.subKeys.size;\n      const topics = topic.subKeys.toArray();\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return { R: topics };\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return { L: topics };\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n\n    createSubTopics(props) {\n      const { model, topicKey, controller, topics, saveRef } = props;\n      const topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      const subTopics = [];\n      topics.forEach(tKey => {\n        const topicProps = {\n          ...props,\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        };\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return { subTopics };\n    },\n\n    layout(props) {\n      const { getRef, model } = props;\n      const links = getRef(linksRefKey(model.editorRootTopicKey));\n      const highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY);\n      const dropEffect = getRef(RefKey.DROP_EFFECT_KEY);\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n\n      const editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic: Topic) {\n        if (topic.key !== model.editorRootTopicKey) {\n          const topicWidget = getRef(topicWidgetRefKey(topic.key));\n          topicWidget && topicWidget.layoutLinks();\n        }\n\n        for (const subKey of topic.subKeys) {\n          layoutTopic(model.getTopic(subKey));\n        }\n      }\n    },\n\n    setLayoutDir(props) {\n      const { layoutDir, model, controller } = props;\n      controller.change(ModelModifier.setLayoutDir({ model, layoutDir }));\n    },\n\n    getRelativeRect(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return getRelativeRect(element, bigView, zoomFactor);\n    },\n\n    getRelativeRectFromViewPort(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n\n    addZoomFactorChangeEventListener(props) {\n      const { controller } = props;\n      controller.run('addTempValueChangeListener', {\n        key: 'ZoomFactor',\n        ...props\n      });\n    },\n\n    removeZoomFactorChangeEventListener(props) {\n      const { controller } = props;\n      controller.run('removeTempValueChangeListener', {\n        key: 'ZoomFactor',\n        ...props\n      });\n    },\n\n    setZoomFactor(props) {\n      const { controller, zoomFactor } = props;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n\n    getZoomFactor(props) {\n      const { controller } = props;\n      return (\n        controller.run('getTempValue', { key: 'ZoomFactor' }) || _zoomFactor\n      );\n    }\n  };\n}\n","import {\n  BlockType,\n  FocusMode,\n  Model,\n  ModelModifier,\n  OpType\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport { List, Stack } from 'immutable';\nconst log = debug('plugin:operation');\n\nexport function OperationPlugin() {\n  const startEditingContent = ({ model, topicKey }) => {\n    return ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n  const startEditingDesc = ({ model, topicKey }) => {\n    const topic = model.getTopic(topicKey);\n    const desc = topic.getBlock(BlockType.DESC);\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model,\n        topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n    model = ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    const { srcKey, dstKey, dropDir } = props;\n    let { model } = props;\n    const srcTopic = model.getTopic(srcKey);\n    const dstTopic = model.getTopic(dstKey);\n\n    const srcParentKey = srcTopic.parentKey;\n    const srcParentTopic = model.getTopic(srcParentKey);\n    let srcParentSubKeys = srcParentTopic.subKeys;\n    const srcIndex = srcParentSubKeys.indexOf(srcKey);\n\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      let dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(m => {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n          .setIn(['topics', srcKey, 'parentKey'], dstKey)\n          .setIn(['topics', dstKey, 'subKeys'], dstSubKeys)\n          .setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      const dstParentKey = dstTopic.parentKey;\n      const dstParentItem = model.getTopic(dstParentKey);\n      let dstParentSubKeys = dstParentItem.subKeys;\n      const dstIndex = dstParentSubKeys.indexOf(dstKey);\n      //src 和 dst 的父亲相同，这种情况要做特殊处理\n      if (srcParentKey === dstParentKey) {\n        let newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(key => {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(srcKey)\n                  .push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(key)\n                  .push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(m => {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n        model = model.withMutations(m => {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n            .setIn(['topics', srcKey, 'parentKey'], dstParentKey)\n            .setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys)\n            .setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n    return model;\n  }\n  const OpMap = new Map([\n    [OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse],\n    [OpType.COLLAPSE_ALL, ModelModifier.collapseAll],\n    [OpType.EXPAND_ALL, ModelModifier.expandAll],\n    [OpType.ADD_CHILD, ModelModifier.addChild],\n    [OpType.ADD_SIBLING, ModelModifier.addSibling],\n    [OpType.DELETE_TOPIC, ModelModifier.deleteTopic],\n    [OpType.FOCUS_TOPIC, ModelModifier.focusTopic],\n    [OpType.SET_STYLE, ModelModifier.setStyle],\n    [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData],\n    [OpType.DELETE_TOPIC_BLOCK,ModelModifier.deleteBlock],\n    [OpType.START_EDITING_CONTENT, startEditingContent],\n    [OpType.START_EDITING_DESC, startEditingDesc],\n    [OpType.DRAG_AND_DROP, dragAndDrop],\n    [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey]\n  ]);\n\n  let undoStack = Stack<Model>();\n  let redoStack = Stack<Model>();\n\n  return {\n    /** plugin can extend Operation Map\n     * for example: A plugin can write a function\n     * getOpMap(props,next) {\n     *   let opMap = next();\n     *   opMap.set(\"OpTypeName\",opFunc);\n     *   return opMap;\n     * }\n     * @param props\n     */\n    getOpMap(props) {\n      return OpMap;\n    },\n    getAllowUndo(props) {\n      const { model, opType } = props;\n      if (opType) {\n        switch (opType) {\n          case OpType.FOCUS_TOPIC:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n          default:\n            break;\n        }\n      }\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n      return model.config.allowUndo;\n    },\n\n    getUndoRedoStack() {\n      return {\n        undoStack,\n        redoStack\n      };\n    },\n\n    setUndoStack(props) {\n      log('setUndoStack', props.undoStack);\n      undoStack = props.undoStack;\n    },\n\n    setRedoStack(props) {\n      log('setRedoStack', props.redoStack);\n      redoStack = props.redoStack;\n    },\n\n    canUndo(props) {\n      const { controller } = props;\n      const { undoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return undoStack.size > 0 && allowUndo;\n    },\n\n    canRedo(props) {\n      const { controller } = props;\n      const { redoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return redoStack.size > 0 && allowUndo;\n    },\n\n    undo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.shift()\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.push(model)\n      });\n      log(newModel);\n      controller.change(newModel);\n    },\n\n    redo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.push(model)\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.shift()\n      });\n      controller.change(newModel);\n    },\n\n    beforeOperation(props) {},\n    operation(props) {\n      const { opType, controller, model, opArray } = props;\n      log('operation:', opType);\n      log('operation:', model);\n      log('operation:', props);\n\n      const opMap = controller.run('getOpMap', props);\n      controller.run('beforeOperation', props);\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n      if (controller.run('getAllowUndo', props)) {\n        const { undoStack } = controller.run('getUndoRedoStack', props);\n        controller.run('setUndoStack', {\n          ...props,\n          undoStack: undoStack.push(model)\n        });\n      }\n      let newModel;\n      if (opArray != null) {\n        if (!Array.isArray(opArray)) {\n          throw new Error('operation: the type of opArray must be array!');\n        }\n        newModel = opArray.reduce((acc, cur) => {\n          const { opType } = cur;\n          if (!opMap.has(opType))\n            throw new Error(`opType:${opType} not exist!`);\n          const opFunc = opMap.get(opType);\n          const res = opFunc({ controller, ...cur, model: acc });\n          return res;\n          return acc;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(`opType:${opType} not exist!`);\n        const opFunc = opMap.get(opType);\n        newModel = opFunc(props);\n      }\n      log('newModel:', newModel);\n      controller.change(newModel);\n      controller.run('afterOperation', props);\n    },\n    afterOperation(props) {}\n  };\n}\n","import { ModelModifier } from '@blink-mind/core';\nimport {\n  Breadcrumb,\n  Breadcrumbs,\n  PopoverPosition,\n  Tooltip\n} from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\n\nconst EditorRootBreadcrumbsRoot = styled.div`\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n  z-index: 4;\n`;\n\nconst TooltipContent = styled.div`\n  max-width: 600px;\n`;\n\nconst BreadcrumbTitle = styled.span``;\n\nexport class EditorRootBreadcrumbs extends BaseWidget {\n  constructor(props) {\n    super(props);\n    this.state = {\n      show: false\n    };\n  }\n\n  setEditorRootTopicKey = topicKey => () => {\n    const { model, controller } = this.props;\n    if (model.editorRootTopicKey !== topicKey) {\n      controller.change(\n        ModelModifier.setEditorRootTopicKey({\n          model,\n          topicKey\n        })\n      );\n    }\n  };\n\n  breadcrumbRenderer = props => {\n    const { text, ...breadProps } = props;\n    const needTooltip = text.length > 8;\n    const title = needTooltip ? text.substr(0, 8) + '...' : text;\n    //TODO\n\n    const content = <TooltipContent>{text}</TooltipContent>;\n    const tooltipProps = {\n      content,\n      position: PopoverPosition.BOTTOM_RIGHT\n    };\n    const breadcrumb = (\n      <Breadcrumb {...breadProps}>\n        <BreadcrumbTitle>{title}</BreadcrumbTitle>\n      </Breadcrumb>\n    );\n    return needTooltip ? (\n      <Tooltip {...tooltipProps}>{breadcrumb}</Tooltip>\n    ) : (\n      breadcrumb\n    );\n\n    // return (\n    //   <Breadcrumb {...breadProps}>\n    //     <BreadcrumbTitle>{title}</BreadcrumbTitle>\n    //   </Breadcrumb>\n    // );\n  };\n\n  render() {\n    const props = this.props;\n    const { model, controller } = props;\n    const editingRootKey = model.editorRootTopicKey;\n    if (editingRootKey === model.rootTopicKey) return null;\n\n    const items = [];\n    let topic = model.getTopic(editingRootKey);\n    while (topic != null) {\n      const title = controller.run('getTopicTitle', {\n        ...props,\n        topicKey: topic.key\n      });\n      items.unshift({\n        text: title,\n        onClick: this.setEditorRootTopicKey(topic.key)\n      });\n      topic = model.getTopic(topic.parentKey);\n    }\n    const breadcrumbProps = {\n      items,\n      breadcrumbRenderer: this.breadcrumbRenderer\n    };\n    return (\n      <EditorRootBreadcrumbsRoot>\n        <Breadcrumbs {...breadcrumbProps} />\n      </EditorRootBreadcrumbsRoot>\n    );\n  }\n}\n","import { Controller, Model, Topic } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { DragScrollWidget } from '../../../components/common';\nimport { EventKey, RefKey, topicRefKey } from '../../../utils';\nconst NodeLayer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst DIV = styled.div`\n  width: 100%;\n  height: 100%;\n  background: ${props => props.theme.background};\n`;\n\nexport interface MindDragScrollWidgetProps {\n  controller: Controller;\n  model: Model;\n  saveRef?: Function;\n  getRef?: Function;\n}\n\nexport class MindDragScrollWidget<\n  P extends MindDragScrollWidgetProps\n> extends React.Component<MindDragScrollWidgetProps> {\n  constructor(props: MindDragScrollWidgetProps) {\n    super(props);\n  }\n\n  componentDidMount(): void {\n    const { getRef, model, controller } = this.props;\n    controller.run('addZoomFactorChangeEventListener', {\n      ...this.props,\n      listener: this.setZoomFactor\n    });\n    const rootTopic: HTMLElement = getRef(\n      topicRefKey(model.editorRootTopicKey)\n    );\n    //TODO\n    const nodeLayer: HTMLElement = getRef('node-layer');\n    const rootTopicRect = rootTopic.getBoundingClientRect();\n    const nodeLayerRect = nodeLayer.getBoundingClientRect();\n    this.dragScrollWidget.setViewBoxScrollDelta(\n      0,\n      rootTopicRect.top -\n        nodeLayerRect.top -\n        this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 +\n        rootTopicRect.height\n    );\n    this.layout();\n  }\n\n  componentWillUnmount(): void {\n    const { controller } = this.props;\n    controller.run('removeZoomFactorChangeEventListener', {\n      ...this.props,\n      listener: this.setZoomFactor\n    });\n  }\n\n  get dragScrollWidget(): DragScrollWidget {\n    return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n  }\n\n  componentDidUpdate(): void {\n    const { controller } = this.props;\n    controller.run('fireEvent', {\n      ...this.props,\n      key: EventKey.CENTER_ROOT_TOPIC\n    });\n    this.layout();\n  }\n\n  layout() {\n    const { controller } = this.props;\n    controller.run('layout', this.props);\n  }\n\n  setZoomFactor = zoomFactor => {\n    this.dragScrollWidget.setZoomFactor(zoomFactor);\n  };\n\n  onWheel = e => {\n    if (e.altKey || e.ctrlKey) {\n      const { controller } = this.props;\n      let zoomFactor = controller.run('getZoomFactor', this.props);\n      zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n      if (zoomFactor < 0.5) zoomFactor = 0.5;\n      if (zoomFactor > 4) zoomFactor = 4;\n      // console.log('zoomFactor=>', zoomFactor);\n      controller.run('setZoomFactor', { ...this.props, zoomFactor });\n    }\n  };\n\n  render() {\n    const { saveRef, model, controller } = this.props;\n    const nodeKey = model.editorRootTopicKey;\n    return (\n      <DIV onWheel={this.onWheel}>\n        <DragScrollWidget\n          {...this.state}\n          enableMouseWheel={false}\n          zoomFactor={model.zoomFactor}\n          ref={saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)}\n        >\n          {(\n            setViewBoxScroll: (left: number, top: number) => void,\n            setViewBoxScrollDelta: (left: number, top: number) => void\n          ) => {\n            const rootWidgetProps = {\n              ...this.props,\n              topicKey: nodeKey,\n              setViewBoxScroll,\n              setViewBoxScrollDelta\n            };\n            return (\n              <NodeLayer ref={saveRef('node-layer')}>\n                {controller.run('renderRootWidget', rootWidgetProps)}\n              </NodeLayer>\n            );\n          }}\n        </DragScrollWidget>\n      </DIV>\n    );\n  }\n}\n","import { Classes, Dialog } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\n\ninterface Props extends BaseProps {\n  saveRef?: Function;\n}\n\nexport class Modals extends BaseWidget<Props> {\n  handleClose = () => {\n    const { controller } = this.props;\n    const handleActiveModalClose = controller.run(\n      'handleActiveModalClose',\n      this.props\n    );\n\n    handleActiveModalClose && handleActiveModalClose();\n  };\n\n  render() {\n    const { controller } = this.props;\n    const activeModal = controller.run('renderModal', this.props);\n    const activeModalProps = controller.run('getActiveModalProps', this.props);\n    return (\n      <Dialog\n        onClose={this.handleClose}\n        isOpen={activeModal !== null}\n        autoFocus\n        enforceFocus\n        usePortal\n        title={activeModalProps && activeModalProps.title}\n        style={activeModalProps && activeModalProps.style}\n      >\n        <div className={Classes.DIALOG_BODY} style={{ minHeight: 0 }}>\n          {activeModal}\n        </div>\n      </Dialog>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  centerPointX,\n  centerPointY,\n  centerX,\n  centerY, getRelativeRect, Point,\n  RefKey\n} from '../../../utils';\n\nimport debug from 'debug';\nimport { contentRefKey, linksSvgRefKey } from '../../../utils';\nconst RootLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\n\nconst log = debug('node:topic-sub-links');\n\ninterface Props extends BaseProps {\n}\n\ninterface State {\n  curves: any[];\n}\n\nexport class RootSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, zoomFactor, controller } = props;\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svg = getRef(linksSvgRefKey(topicKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const contentRect = getRelativeRect(content,bigView,zoomFactor);\n    const svgRect = getRelativeRect(svg,bigView,zoomFactor);\n    let p1: Point, p2: Point;\n\n    p1 = {\n      x: centerX(contentRect) - svgRect.left,\n      y: centerY(contentRect) - svgRect.top\n    };\n    const curves = [];\n    topic.subKeys.forEach(key => {\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n      const lineType = linkStyle.lineType;\n      const subTopicContent = getRef(contentRefKey(key));\n      const rect = getRelativeRect(subTopicContent,bigView,zoomFactor);\n      if (rect.left > contentRect.right) {\n        p2 = {\n          x: rect.left,\n          y: centerY(rect)\n        };\n      } else {\n        p2 = {\n          x: rect.right,\n          y: centerY(rect)\n        };\n      }\n      p2 = { x: p2.x - svgRect.left, y: p2.y - svgRect.top };\n      let curve;\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} C ${p1.x} ${centerPointY(\n          p1,\n          p2\n        )} ${centerPointX(p1, p2)} ${p2.y} ${p2.x} ${p2.y}`;\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p2.y > p1.y ? 1 : -1;\n        const hDir = p2.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        if (radius == null) {\n          throw new Error(\n            'link line type is round, but lineRadius is not provided!'\n          );\n        }\n        if (p2.y === p1.y) {\n          curve = `M ${p1.x} ${p1.y} H ${p2.x}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y}  V ${p2.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p1.x + radius * hDir} ${p2.y} H ${p2.x}`;\n        }\n      }\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    const { topicKey, saveRef } = this.props;\n    return (\n      <RootLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </RootLinksSvg>\n    );\n  }\n}\n","import { DiagramLayoutType, KeyType, TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { topicRefKey } from '../../../utils';\n\nconst log = debug('RootNode');\n\nconst LayerPart = styled.div`\n  display: flex;\n  position: relative;\n\n  align-items: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'};\n  flex-direction: column;\n\n  padding: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT\n      ? '15px 60px 15px 0px'\n      : '15px 0px 15px 60px'};\n`;\n\nconst Topic = styled.div`\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class RootWidget extends React.Component<Props> {\n  renderPartTopics(topics: KeyType[], dir: string) {\n    const { controller, saveRef } = this.props;\n    const res = controller.run('createSubTopics', {\n      ...this.props,\n      dir,\n      isRoot: true,\n      topics\n    });\n    if (!res) return null;\n    const { subTopics } = res;\n    const cxName = `bm-layer-${dir === TopicDirection.LEFT ? 'left' : 'right'}`;\n    return (\n      //@ts-ignore\n      <LayerPart topicDirection={dir} ref={saveRef(cxName)}>\n        {subTopics}\n      </LayerPart>\n    );\n  }\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { model, topicKey, saveRef, controller, dir } = props;\n    const topicStyle = controller.run('getTopicContentStyle', props);\n    const config = model.config;\n    const topicContent = controller.run('renderTopicContent', {\n      ...props,\n      topicStyle,\n      dir: TopicDirection.MAIN\n    });\n    const partTopics = controller.run('getPartTopics', {\n      layout: config.layoutDir,\n      model,\n      topicKey\n    });\n    const rootTopic = (\n      <Topic ref={saveRef(topicRefKey(topicKey))}>{topicContent}</Topic>\n    );\n    const children = controller.run('renderRootWidgetOtherChildren', props);\n    switch (config.layoutDir) {\n      case DiagramLayoutType.LEFT_AND_RIGHT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.LEFT_TO_RIGHT:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.RIGHT_TO_LEFT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.TOP_TO_BOTTOM:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.B, 'B')}\n            {children}\n          </>\n        );\n    }\n    return null;\n  }\n}\n","import { Divider, MenuItem } from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { Flex } from '../../../../components/common';\n\nexport const SettingTitle = styled.div`\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n`;\n\nexport const SettingItem = styled.span`\n  margin: 0px 10px 0px 0px;\n`;\n\nexport const SettingRow = styled(Flex)`\n  margin: 5px 0;\n`;\n\nexport const SettingGroup = props => {\n  return (\n    <div>\n      {props.children}\n      <Divider style={{ margin: '10px 0' }} />\n    </div>\n  );\n};\n\nexport const ColorBar = styled.div`\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ${props => props.color};\n`;\n\nexport const WithBorder = styled.div`\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n`;\n\nexport const renderItem = unit => (\n  width,\n  { handleClick, modifiers, query }\n) => {\n  return (\n    <MenuItem text={`${width}${unit}`} key={width} onClick={handleClick} />\n  );\n};\n\nexport const PxSelect = Select.ofType();\n\nexport const borderWidthItems = [...Array(7).keys()];\n","import { Popover } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { SketchPicker } from 'react-color';\nimport { iconClassName, IconName } from '../../../../utils';\nimport {\n  ColorBar,\n  PxSelect,\n  renderItem,\n  SettingGroup,\n  SettingItem,\n  SettingTitle,\n  WithBorder\n} from './components';\n\nimport { Button } from '@blueprintjs/core';\n\nconst borderWidthItems = [...Array(7).keys()];\nconst borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nconst borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nexport function BorderStyleEditor(props) {\n  const { topicStyle, setStyle } = props;\n  const handleBorderWidthChange = value => {\n    // log('handleBorderWithChange:', value);\n    setStyle({ borderWidth: `${value}px` });\n  };\n\n  const handleBorderStyleChange = value => {\n    setStyle({ borderStyle: value });\n  };\n\n  const handleBorderRadiusChange = value => {\n    // log('handleBorderRadiusChange:', value);\n    setStyle({ borderRadius: `${value}px` });\n  };\n\n  const handleBorderColorChange = color => {\n    setStyle({ borderColor: color.hex });\n  };\n\n  return (\n    <SettingGroup>\n      <SettingTitle>Border</SettingTitle>\n      <div>\n        <SettingItem>\n          <PxSelect\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            filterable={false}\n            onItemSelect={handleBorderWidthChange}\n          >\n            <Button\n              text={`width: ${\n                topicStyle.borderWidth ? topicStyle.borderWidth : '0px'\n              }`}\n            />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <PxSelect\n            items={borderStyleItems}\n            itemRenderer={renderItem('')}\n            filterable={false}\n            onItemSelect={handleBorderStyleChange}\n          >\n            <Button\n              text={`style: ${\n                topicStyle.borderStyle ? topicStyle.borderStyle : 'none'\n              }`}\n            />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <PxSelect\n            items={borderRadiusItems}\n            itemRenderer={renderItem('px')}\n            filterable={false}\n            onItemSelect={handleBorderRadiusChange}\n          >\n            <Button text={`radius: ${topicStyle.borderRadius}`} />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <Popover>\n            <WithBorder>\n              <div className={iconClassName(IconName.COLOR_PICKER)} />\n              <ColorBar color={topicStyle.borderColor} />\n            </WithBorder>\n            <div>\n              <SketchPicker\n                color={topicStyle.borderColor}\n                onChangeComplete={handleBorderColorChange}\n              />\n            </div>\n          </Popover>\n        </SettingItem>\n      </div>\n    </SettingGroup>\n  );\n}\n","import { Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { SettingGroup, SettingItem } from './components';\n\nexport function ClearAllCustomStyle(props) {\n  const { controller } = props;\n  const handleClearAllCustomStyle = e => {\n    controller.run('clearAllCustomStyle', props);\n  };\n\n  return (\n    <SettingGroup>\n      <SettingItem>\n        <Button onClick={handleClearAllCustomStyle}>\n          Clear All Custom Styles\n        </Button>\n      </SettingItem>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle } from '@blink-mind/core';\nimport { Button, MenuItem, Popover } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { SketchPicker } from 'react-color';\nimport { Margin } from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\nimport {\n  borderWidthItems,\n  ColorBar,\n  PxSelect,\n  renderItem,\n  SettingGroup,\n  SettingItem,\n  SettingRow,\n  SettingTitle,\n  WithBorder\n} from './components';\n\nconst lineTypes = ['curve', 'round', 'line'];\n\nconst renderLineTypeItem = (lineType, { handleClick, modifiers, query }) => {\n  return <MenuItem text={`${lineType}`} key={lineType} onClick={handleClick} />;\n};\n\nexport function LinkStyleEditor(props) {\n  const { controller } = props;\n  // const topicStyle: TopicStyle = controller.run('getTopicStyle', props);\n  const linkStyle: LinkStyle = controller.run('getLinkStyle', props);\n  const subLinkStyle: LinkStyle = controller.run('getSubLinkStyle', props);\n\n  const handleLinkWidthChange = value => {\n    controller.run('setLinkStyle', {\n      ...props,\n      linkStyle: { lineWidth: `${value}px` }\n    });\n  };\n\n  const handleLinkTypeChange = value => {\n    controller.run('setLinkStyle', {\n      ...props,\n      linkStyle: { lineType: value }\n    });\n  };\n\n  const handleSubLinkWidthChange = value => {\n    controller.run('setSubLinkStyle', {\n      ...props,\n      subLinkStyle: { lineWidth: `${value}px` }\n    });\n  };\n\n  const handleSubLinkTypeChange = value => {\n    controller.run('setSubLinkStyle', {\n      ...props,\n      subLinkStyle: { lineType: value }\n    });\n  };\n\n  const handleLinkColorChange = color => {\n    controller.run('setLinkStyle', {\n      ...props,\n      linkStyle: { lineColor: color.hex }\n    });\n  };\n\n  const handleSubLinkColorChange = color => {\n    controller.run('setSubLinkStyle', {\n      ...props,\n      subLinkStyle: { lineColor: color.hex }\n    });\n  };\n\n  return (\n    <SettingGroup>\n      <SettingTitle>Link</SettingTitle>\n      <SettingRow alignItems=\"center\">\n        <Margin margin=\"0 5px 0 0\">LinkToParent: </Margin>\n        <SettingItem>\n          <PxSelect\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            filterable={false}\n            onItemSelect={handleLinkWidthChange}\n          >\n            <Button\n              text={`width: ${linkStyle ? linkStyle.lineWidth + 'px' : '0px'}`}\n            />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <PxSelect\n            items={lineTypes}\n            itemRenderer={renderLineTypeItem}\n            filterable={false}\n            onItemSelect={handleLinkTypeChange}\n          >\n            <Button text={`lineType: ${linkStyle.lineType}`} />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <Popover>\n            <WithBorder>\n              <div className={iconClassName(IconName.COLOR_PICKER)} />\n              <ColorBar color={linkStyle.lineColor} />\n            </WithBorder>\n            <div>\n              <SketchPicker\n                color={linkStyle.lineColor}\n                onChangeComplete={handleLinkColorChange}\n              />\n            </div>\n          </Popover>\n        </SettingItem>\n      </SettingRow>\n      <SettingRow alignItems=\"center\">\n        <Margin margin=\"0 5px 0 0\">SubLinks: </Margin>\n        <SettingItem>\n          <PxSelect\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            filterable={false}\n            onItemSelect={handleSubLinkWidthChange}\n          >\n            <Button\n              text={`width: ${\n                subLinkStyle ? subLinkStyle.lineWidth + 'px' : '0px'\n              }`}\n            />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <PxSelect\n            items={lineTypes}\n            itemRenderer={renderLineTypeItem}\n            filterable={false}\n            onItemSelect={handleSubLinkTypeChange}\n          >\n            <Button text={`lineType: ${subLinkStyle.lineType}`} />\n          </PxSelect>\n        </SettingItem>\n        <SettingItem>\n          <Popover>\n            <WithBorder>\n              <div className={iconClassName(IconName.COLOR_PICKER)} />\n              <ColorBar color={subLinkStyle.lineColor} />\n            </WithBorder>\n            <div>\n              <SketchPicker\n                color={subLinkStyle.lineColor}\n                onChangeComplete={handleSubLinkColorChange}\n              />\n            </div>\n          </Popover>\n        </SettingItem>\n      </SettingRow>\n    </SettingGroup>\n  );\n}\n","import { InputGroup, NumericInput, Popover } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { SketchPicker } from 'react-color';\nimport { Flex, Margin } from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\nimport {\n  ColorBar,\n  SettingGroup,\n  SettingItem,\n  SettingTitle,\n  WithBorder\n} from './components';\n\nexport function TextStyleEditor(props) {\n  const { topicStyle, setStyle } = props;\n  const handleFontSizeChange = value => {\n    // log('handleFontSizeChange:', value);\n    setStyle({ fontSize: value });\n  };\n\n  const handleLineHeightChange = e => {\n    // log('handleLineHeightChange:', e.target.value);\n    setStyle({ lineHeight: e.target.value });\n  };\n\n  const handleColorChange = color => {\n    setStyle({ color: color.hex });\n  };\n\n  const fontSizeNumInputProps = {\n    min: 12,\n    max: 100,\n    value: parseInt(topicStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  const lineHeightInputProps = {\n    style: {\n      width: 50\n    },\n    value: topicStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Text Editor</SettingTitle>\n      <Flex>\n        <SettingItem>\n          <Flex alignItems=\"center\">\n            <Margin margin=\"0 5px 0 0\">FontSize: </Margin>\n            <NumericInput {...fontSizeNumInputProps} />\n          </Flex>\n        </SettingItem>\n        <SettingItem>\n          <Flex alignItems=\"center\">\n            <Margin margin=\"0 5px 0 0\">LineHeight: </Margin>\n            <InputGroup {...lineHeightInputProps} />\n          </Flex>\n        </SettingItem>\n        <SettingItem>\n          <Popover>\n            <WithBorder>\n              <div className={iconClassName(IconName.COLOR_PICKER)} />\n              <ColorBar color={topicStyle.color} />\n            </WithBorder>\n            <div>\n              <SketchPicker\n                color={topicStyle.color}\n                onChangeComplete={handleColorChange}\n              />\n            </div>\n          </Popover>\n        </SettingItem>\n      </Flex>\n    </SettingGroup>\n  );\n}\n","import { OpType, TopicContentStyle } from '@blink-mind/core';\nimport { Button, Popover } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport { SketchPicker } from 'react-color';\nimport styled from 'styled-components';\nimport {\n  BaseWidget,\n  CloseIcon,\n  IconBg,\n  ShowMenuIcon,\n  Title\n} from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\nimport { BorderStyleEditor } from './border-style-editor';\nimport { ClearAllCustomStyle } from './clear-all-custom-style';\nimport {\n  ColorBar,\n  SettingGroup,\n  SettingItem,\n  SettingTitle,\n  WithBorder\n} from './components';\nimport { LinkStyleEditor } from './link-style-editor';\nimport { TextStyleEditor } from './text-style-editor';\n\nconst log = debug('node:style-editor');\n\nconst StyleEditorRoot = styled.div`\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  z-index: 4;\n`;\n\nconst PopRoot = styled.div`\n  padding: 10px;\n`;\n\nexport class StyleEditor extends BaseWidget {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showPanel: false\n    };\n  }\n\n  setShowPanel = showPanel => () => {\n    this.setState({\n      showPanel: showPanel\n    });\n  };\n\n  setTopicContentStyle = style => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('setTopicContentStyle', { ...props, style });\n  };\n\n  handleBackgroundColorChange = color => {\n    this.setTopicContentStyle({ background: color.hex });\n  };\n\n  handleClearStyle = () => {\n    if (this.topic.style) {\n      this.operation(OpType.SET_STYLE, { ...this.props, style: null });\n      this.setState({});\n    }\n  };\n\n  copiedStyle;\n\n  handleCopyStyle = () => {\n    const props = this.props;\n    const { controller } = props;\n    this.copiedStyle = controller.run('getTopicStyle', props);\n    log(this.copiedStyle);\n  };\n\n  handlePasteStyle = () => {\n    if (this.copiedStyle) {\n      this.operation(OpType.SET_STYLE, {\n        ...this.props,\n        style: JSON.stringify(this.copiedStyle)\n      });\n      this.setState({});\n    }\n  };\n\n  render() {\n    const props = this.props;\n    const { controller, model } = props;\n    if (!model.focusKey) return null;\n    const topicStyle: TopicContentStyle = controller.run(\n      'getTopicContentStyle',\n      props\n    );\n    if (!this.state.showPanel) {\n      return (\n        <StyleEditorRoot>\n          <IconBg onClick={this.setShowPanel(true)}>\n            <ShowMenuIcon className={iconClassName(IconName.SHOW_MENU)} />\n          </IconBg>\n        </StyleEditorRoot>\n      );\n    }\n    const setStyle = this.setTopicContentStyle;\n    return (\n      <StyleEditorRoot>\n        <Title>\n          <CloseIcon\n            className={iconClassName(IconName.CLOSE)}\n            onClick={this.setShowPanel(false)}\n          />\n        </Title>\n        <PopRoot>\n          {BorderStyleEditor({ ...props, topicStyle, setStyle })}\n          {TextStyleEditor({ ...props, topicStyle, setStyle })}\n          <SettingGroup>\n            <SettingTitle>Background</SettingTitle>\n            <div>\n              <SettingItem>\n                <Popover>\n                  <WithBorder>\n                    <div className={iconClassName(IconName.COLOR_PICKER)} />\n                    <ColorBar color={topicStyle.background} />\n                  </WithBorder>\n                  <div>\n                    <SketchPicker\n                      color={topicStyle.background}\n                      onChangeComplete={this.handleBackgroundColorChange}\n                    />\n                  </div>\n                </Popover>\n              </SettingItem>\n            </div>\n          </SettingGroup>\n          {LinkStyleEditor(props)}\n          <SettingGroup>\n            <SettingItem>\n              <Button onClick={this.handleClearStyle}>Clear Topic Style</Button>\n            </SettingItem>\n            <SettingItem>\n              <Button onClick={this.handleCopyStyle}>Copy Style</Button>\n            </SettingItem>\n            <SettingItem>\n              <Button onClick={this.handlePasteStyle}>Paste Style</Button>\n            </SettingItem>\n          </SettingGroup>\n          {ClearAllCustomStyle(props)}\n        </PopRoot>\n      </StyleEditorRoot>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport cx from 'classnames';\nimport * as React from 'react';\nimport styled, { css } from 'styled-components';\nimport { collapseRefKey } from '../../../utils';\n\nconst Icon = styled.div`\n  position: absolute;\n  top: calc(50% - 10px);\n  ${({ dir }) => {\n    if (dir === TopicDirection.RIGHT)\n      return css`\n        right: -25px;\n      `;\n    if (dir === TopicDirection.LEFT)\n      return css`\n        left: -25px;\n      `;\n  }};\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ${props => props.background};\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n`;\n\nexport function TopicCollapseIcon(props) {\n  const { model, topicKey, topicStyle, dir, saveRef, onClickCollapse } = props;\n  const topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? (\n    <Icon\n      ref={saveRef(collapseRefKey(topicKey))}\n      onClick={onClickCollapse}\n      background={topicStyle.background}\n      dir={dir}\n      className={cx({\n        icon: true,\n        iconfont: true,\n        [`bm-${topic.collapse ? 'plus' : 'minus'}`]: true\n      })}\n    />\n  ) : null;\n}\n","import debug from 'debug';\nimport * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\nconst log = debug('node:topic-content2');\n\nconst EditingRoot = styled.div`\n  position: relative;\n`;\n\nconst EditingWrapper = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n`;\nconst cancelEvent = e => {\n  log('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\nexport function TopicContent(props) {\n  const { controller, model, topicKey, getRef } = props;\n  const readOnly = model.editingContentKey !== topicKey;\n  const editor = controller.run('renderTopicContentEditor', {\n    ...props,\n    readOnly\n  });\n  let child;\n  if (readOnly) {\n    child = editor;\n  } else {\n    let wrapper;\n    const wrapperRef = ref => {\n      if (ref) {\n        wrapper = ref;\n        contentResizeObserver.observe(wrapper);\n      }\n    };\n    let rect = { width: 50, height: 40 };\n    const editorDiv = getRef(`content-editor-${topicKey}`);\n    if (editorDiv) rect = editorDiv.getBoundingClientRect();\n    const contentResizeCallback = (\n      entries: ResizeObserverEntry[],\n      observer: ResizeObserver\n    ) => {\n      const r = entries[0].contentRect;\n      wrapper.style.left = (rect.width - r.width) / 2 + 'px';\n      wrapper.style.top = (rect.height - r.height) / 2 + 'px';\n    };\n    const contentResizeObserver = new ResizeObserver(contentResizeCallback);\n    log(rect);\n    child = (\n      <>\n        <div style={{ width: rect.width, height: rect.height }}></div>\n        {/*<Dialog isOpen>{editor}</Dialog>*/}\n        <EditingWrapper ref={wrapperRef}>{editor}</EditingWrapper>\n      </>\n    );\n  }\n  return (\n    <EditingRoot onDragEnter={cancelEvent} onDragOver={cancelEvent}>\n      {child}\n    </EditingRoot>\n  );\n}\n","import { FocusMode, OpType, TopicDirection } from '@blink-mind/core';\nimport { ContextMenuTarget } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { collapseRefKey, contentRefKey } from '../../../utils';\n\nconst log = debug('node:topic-content-widget');\n\ninterface TopicContentProps {\n  dragEnter?: boolean;\n}\n\nconst TopicContent = styled.div<TopicContentProps>`\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n`;\n\nconst TopicContentWithDropArea = styled.div`\n  position: relative;\n`;\n\ninterface Props extends BaseProps {\n  draggable: boolean;\n}\n\ninterface State {\n  dragEnter: boolean;\n}\n\n@ContextMenuTarget\nexport class TopicContentWidget extends BaseWidget<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dragEnter: false\n    };\n  }\n\n  onDragStart = ev => {\n    this.run('handleTopicDragStart', { ...this.props, ev });\n  };\n\n  onDragOver = ev => {\n    // log('onDragOver');\n    ev.preventDefault();\n  };\n\n  onDragEnter = ev => {\n    log('onDragEnter', this.props.topicKey);\n    this.run('handleTopicDragEnter', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDragLeave = ev => {\n    this.run('handleTopicDragLeave', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDrop = ev => {\n    log('onDrop');\n    this.run('handleTopicDrop', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  public renderContextMenu() {\n    const { controller } = this.props;\n    this.operation(OpType.FOCUS_TOPIC, {\n      ...this.props,\n      focusMode: FocusMode.SHOW_POPUP\n    });\n    return controller.run('renderTopicContextMenu', this.props);\n  }\n\n  public onContextMenuClose() {\n    // Optional method called once the context menu is closed.\n  }\n\n  handleTopicClickTimeout;\n\n  onClick = ev => {\n    // log('onClick');\n    const props = this.props;\n    const { controller } = props;\n    //TODO bug [Violation] 'setTimeout' handler took 69ms\n    this.handleTopicClickTimeout = setTimeout(() => {\n      log('handleTopicClick');\n      //注意这里要传递this.props, 而不是props, 因为会先调用onClick, 再调用其他的topic-content-editor的onClickOutside\n      //其他组件的onClickOutside是个同步的函数,会设置新的model, 如果这里用props传参,会导致model 还是老的model\n      controller.run('handleTopicClick', { ...this.props, ev });\n    }, 200);\n  };\n\n  onDoubleClick = ev => {\n    clearTimeout(this.handleTopicClickTimeout);\n    const { controller } = this.props;\n    log('handleTopicDoubleClick');\n    controller.run('handleTopicDoubleClick', { ...this.props, ev });\n  };\n\n  needRelocation: boolean = false;\n  oldCollapseIconVector;\n\n  componentDidUpdate() {\n    if (this.needRelocation) {\n      const {\n        getRef,\n        topicKey,\n        setViewBoxScrollDelta,\n        controller\n      } = this.props;\n      const newIcon = getRef(collapseRefKey(topicKey));\n      const newRect = newIcon.getBoundingClientRect();\n      // const newVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: getRef(collapseRefKey(topicKey))\n      // });\n      const newVector = [\n        newRect.left + newRect.width / 2,\n        newRect.top + newRect.height / 2\n      ];\n      const z = controller.run('getZoomFactor', {\n        ...this.props\n      });\n      log('newVector:', newVector);\n      log('oldVector:', this.oldCollapseIconVector);\n      //TODO bug\n      const vector = [\n        newVector[0] - this.oldCollapseIconVector[0],\n        newVector[1] - this.oldCollapseIconVector[1]\n      ];\n      // vector = [vector[0]*z,vector[1]*z]\n      log('vector', vector);\n      setViewBoxScrollDelta(vector[0], vector[1]);\n      this.needRelocation = false;\n    }\n  }\n\n  onClickCollapse = e => {\n    e.stopPropagation();\n    const { topicKey, getRef, controller } = this.props;\n    this.needRelocation = true;\n    const collapseIcon = getRef(collapseRefKey(topicKey));\n    const rect = collapseIcon.getBoundingClientRect();\n    log('oldRect', rect);\n    this.oldCollapseIconVector = [\n      rect.left + rect.width / 2,\n      rect.top + rect.height / 2\n    ];\n    log('oldCollapseIconVector', this.oldCollapseIconVector);\n    // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n    //   ...this.props,\n    //   element: collapseIcon\n    // });\n    this.operation(OpType.TOGGLE_COLLAPSE, this.props);\n  };\n\n  render() {\n    const props = this.props;\n    const { saveRef, topicKey, model, controller, topicStyle, dir } = props;\n    log('render', topicKey, model.focusMode);\n    const draggable = model.editingContentKey !== topicKey;\n    const collapseIcon = controller.run('renderTopicCollapseIcon', {\n      ...props,\n      onClickCollapse: this.onClickCollapse.bind(this)\n    });\n    const prevDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'prev'\n    });\n    const nextDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'next'\n    });\n    const dropEventHandlers = {\n      onDragEnter: this.onDragEnter,\n      onDragLeave: this.onDragLeave,\n      onDragOver: this.onDragOver,\n      onDrop: this.onDrop\n    };\n    // log(topicKey, 'style', topicStyle);\n    return (\n      <TopicContentWithDropArea>\n        {prevDropArea}\n        <TopicContent\n          style={topicStyle}\n          draggable={draggable}\n          ref={saveRef(contentRefKey(topicKey))}\n          onDragStart={this.onDragStart}\n          onClick={this.onClick}\n          onDoubleClick={this.onDoubleClick}\n          {...dropEventHandlers}\n        >\n          {controller.run('renderTopicBlocks', props)}\n        </TopicContent>\n        {nextDropArea}\n        {dir !== TopicDirection.MAIN && collapseIcon}\n      </TopicContentWithDropArea>\n    );\n  }\n}\n","import { Menu } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { BaseWidget } from '../../../components/common';\n\nexport class TopicContextMenu extends BaseWidget {\n  render() {\n    const { controller } = this.props;\n    return (\n      <Menu>{controller.run('customizeTopicContextMenu', this.props)}</Menu>\n    );\n  }\n}\n","import { BlockType, FocusMode, OpType } from '@blink-mind/core';\nimport { Classes, Popover, PopoverInteractionKind } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { TopicBlockIcon } from '../../../components/common/styled';\nimport {\n  cancelEvent,\n  Icon,\n  iconClassName,\n  IconName,\n  RefKey\n} from '../../../utils';\n\nconst log = debug('node:topic-desc');\n\nconst TooltipContentWrapper = styled.div`\n  overflow: auto;\n`;\n\nexport function TopicDesc(props) {\n  const { controller, model, topicKey, getRef } = props;\n  const isEditing = model.editingDescKey === topicKey;\n  log('isEditing', isEditing);\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('operation', {\n      ...props,\n      opType: OpType.START_EDITING_DESC\n    });\n  };\n\n  const desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (\n    !isEditing &&\n    controller.run('isBlockEmpty', { ...props, block: desc.block })\n  )\n    return null;\n  const descEditor = controller.run('renderTopicDescEditor', props);\n  const diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  const style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n  if (diagramRoot) {\n    const dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = `${dRect.width * 0.6}px`;\n    style.maxHeight = `${dRect.height * 0.8}px`;\n  }\n  const tooltipContent = (\n    <TooltipContentWrapper\n      onClick={cancelEvent}\n      classname={Classes.POPOVER_DISMISS}\n      style={style}\n    >\n      {descEditor}\n    </TooltipContentWrapper>\n  );\n  const icon = (\n    <TopicBlockIcon\n      onClick={onClick}\n      className={iconClassName(IconName.NOTES)}\n      tabIndex={-1}\n    />\n  );\n  const tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n\n  const descIcon = desc.block && <Popover {...tooltipProps}></Popover>;\n  return descIcon;\n}\n","import { FocusMode } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  contentRefKey,\n  getRelativeRect,\n  RefKey,\n} from '../../../utils';\n\nconst FocusHighlightSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicHighlight extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const { getRef, model, zoomFactor } = this.props;\n    const focusKey = model.focusKey;\n    const focusMode = model.focusMode;\n    if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    const content = getRef(contentRefKey(focusKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n    this.setState({\n      content: (\n        <rect\n          x={x}\n          y={y}\n          width={width}\n          height={height}\n          fill=\"none\"\n          stroke={model.config.theme.highlightColor}\n          strokeWidth={2}\n        />\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <FocusHighlightSvg ref={saveRef(RefKey.SVG_HIGHLIGHT_KEY)}>\n        {this.state.content}\n      </FocusHighlightSvg>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  centerPointX,\n  centerPointY,\n  centerY,\n  collapseRefKey,\n  contentRefKey, getRelativeRect,\n  linksSvgRefKey,\n  Point,\n  RefKey\n} from '../../../utils';\n\nconst TopicLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\nimport debug from 'debug';\nconst log = debug('node:topic-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class TopicSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, dir, controller } = props;\n    const z = controller.run('getZoomFactor',props);\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svg = getRef(linksSvgRefKey(topicKey));\n    const collapseIcon = getRef(collapseRefKey(topicKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const svgRect =  getRelativeRect(svg,bigView,z);\n    const collapseRect = getRelativeRect(collapseIcon,bigView,z);\n    const contentRect = getRelativeRect(content,bigView,z);\n    log(topicKey);\n    log('svgRect',svgRect);\n    log('collapseRect',collapseRect);\n    log('contentRect',contentRect);\n    let p1: Point, p2: Point, p3: Point;\n\n    if (dir === TopicDirection.RIGHT) {\n      p1 = {\n        x: 0,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.right - svgRect.left + 10,\n        y: p1.y\n      };\n    } else if (dir === TopicDirection.LEFT) {\n      p1 = {\n        x: svgRect.right - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.left - svgRect.left - 10,\n        y: p1.y\n      };\n    }\n    const curves = [];\n\n    topic.subKeys.forEach(key => {\n      let curve;\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n      const subContent = getRef(contentRefKey(key));\n      const rect = getRelativeRect(subContent,bigView,z);\n\n      if (dir === TopicDirection.RIGHT) {\n        p3 = {\n          x: rect.left - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      if (dir === TopicDirection.LEFT) {\n        p3 = {\n          x: rect.right - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      const { lineType } = linkStyle;\n\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} C ${p2.x} ${centerPointY(\n          p2,\n          p3\n        )} ${centerPointX(p2, p3)} ${p3.y} ${p3.x} ${p3.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p3.y > p1.y ? 1 : -1;\n        const hDir = p3.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        // if (p3.y === p1.y) { //这样判断不可靠\n        if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n          curve = `M ${p1.x} ${p1.y} L ${p3.x} ${p3.y}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y} H ${p2.x} V ${p3.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p2.x + radius * hDir} ${p3.y} H ${p3.x}`;\n        }\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} H ${p2.x} L ${p3.x} ${p3.y}`;\n      }\n\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    const { topicKey, saveRef, model } = this.props;\n    const style = { transform: `scale(${1 / model.zoomFactor})` };\n    return (\n      <TopicLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </TopicLinksSvg>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { linksRefKey, topicRefKey } from '../../../utils';\nimport { TopicSubLinks } from './topic-sub-links';\n\nconst log = debug('node:topic-widget');\n\ntype NodeProps = {\n  topicDirection: string;\n};\n\nconst Node = styled.div<NodeProps>`\n  display: flex;\n  align-items: center;\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface NodeChildrenProps {\n  dir: string;\n  marginH: number;\n}\n\n// TODO\nconst NodeChildren = styled.div<NodeChildrenProps>`\n  position: relative;\n  padding: ${props =>\n    props.dir === TopicDirection.RIGHT\n      ? `0 0 0 ${props.marginH}px`\n      : `0 ${props.marginH}px 0 0`};\n`;\n\ninterface NodeTopicProps {\n  topicDirection: string;\n}\n\nconst NodeTopic = styled.div<NodeTopicProps>`\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class TopicWidget extends React.Component<Props> {\n  renderSubTopics() {\n    const props = this.props;\n    const { controller, model, topicKey, dir } = props;\n    const topics = model.getTopic(topicKey).subKeys.toArray();\n    const res = controller.run('createSubTopics', { ...props, topics });\n    if (!res) return null;\n    const { subTopics } = res;\n    const subLinks = controller.run('renderSubLinks', props);\n    return (\n      <NodeChildren dir={dir} marginH={model.config.theme.marginH}>\n        {subTopics} {subLinks}\n      </NodeChildren>\n    );\n  }\n\n  // componentDidUpdate(): void {\n  //   this.layoutLinks();\n  // }\n  //\n  // componentDidMount(): void {\n  //   this.layoutLinks();\n  // }\n\n  layoutLinks() {\n    log('layoutLinks');\n    const { getRef, topicKey } = this.props;\n    const links: TopicSubLinks = getRef(linksRefKey(topicKey));\n    links && links.layout();\n  }\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { controller, topicKey, dir, saveRef } = props;\n    const topicStyle = controller.run('getTopicContentStyle', props);\n    const propsMore = {\n      ...props,\n      topicStyle\n    };\n    const topicContent = controller.run('renderTopicContent', propsMore);\n\n    return (\n      <Node topicDirection={dir}>\n        <NodeTopic topicDirection={dir} ref={saveRef(topicRefKey(topicKey))}>\n          {topicContent}\n        </NodeTopic>\n        {this.renderSubTopics()}\n      </Node>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { Classes, Position, Tooltip } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget, Btn } from '../../../../components/common';\nimport {\n  EventKey,\n  getRelativeVector,\n  Icon,\n  IconName,\n  RefKey,\n  topicRefKey\n} from '../../../../utils';\n\nconst log = debug('node:view-port-viewer');\n\nconst ViewerRoot = styled.div`\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  z-index: 3;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n`;\n\nconst Item_ = styled(Btn)`\n  margin: 10px;\n`;\n\nconst ZoomFactorSpan = styled.span`\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n`;\n\nconst Item = props => {\n  return (\n    <Tooltip\n      content={props.tooltip}\n      position={Position.TOP}\n      className={Classes.ICON}\n    >\n      <Item_ onClick={props.onClick}>{props.children}</Item_>\n    </Tooltip>\n  );\n};\n\nexport class ViewPortViewer extends BaseWidget {\n  constructor(props) {\n    super(props);\n  }\n\n  componentDidMount(): void {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addZoomFactorChangeEventListener', {\n      ...props,\n      listener: this.zoomFactorChange\n    });\n  }\n\n  componentWillUnmount(): void {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('removeZoomFactorChangeEventListener', {\n      ...props,\n      listener: this.zoomFactorChange\n    });\n  }\n\n  zoomFactorChange = zoomFactor => {\n    log('zoomFactorChange', zoomFactor);\n    this.setState({ zoomFactor });\n  };\n\n  onClickResetZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: 1\n    });\n  };\n\n  onClickAddZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: zoomFactor + 0.1\n    });\n  };\n\n  onClickMinusZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: zoomFactor - 0.1\n    });\n  };\n\n  onClickCollapseAll = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addEventListener', {\n      ...props,\n      key: EventKey.CENTER_ROOT_TOPIC,\n      listener: this.centerRootTopic,\n      once: true\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.COLLAPSE_ALL\n    });\n  };\n\n  onClickExpandAll = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addEventListener', {\n      ...props,\n      key: EventKey.CENTER_ROOT_TOPIC,\n      listener: this.centerRootTopic,\n      once: true\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.EXPAND_ALL\n    });\n  };\n\n  centerRootTopic = () => {\n    const { getRef, model, controller } = this.props;\n    const rootTopic = getRef(topicRefKey(model.editorRootTopicKey));\n    const dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n    const viewBox = dragScroll.viewBox;\n    const vector = getRelativeVector(rootTopic, viewBox);\n    //TODO\n    dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);\n  };\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    return (\n      <ViewerRoot>\n        <Item onClick={this.onClickCollapseAll} tooltip=\"collapse all\">\n          {Icon(IconName.COLLAPSE_ALL)}\n        </Item>\n        <Item onClick={this.onClickExpandAll} tooltip=\"expand all\">\n          {Icon(IconName.EXPAND_ALL)}\n        </Item>\n        <Item onClick={this.centerRootTopic} tooltip=\"center root topic\">\n          {Icon(IconName.CENTER)}\n        </Item>\n        <Item onClick={this.onClickMinusZoom} tooltip=\"zoom in\">\n          {Icon(IconName.MINUS)}\n        </Item>\n        <Item onClick={this.onClickResetZoom} tooltip=\"reset zoom\">\n          <ZoomFactorSpan>{`zoom:${Math.floor(\n            zoomFactor * 100\n          )}%`}</ZoomFactorSpan>\n        </Item>\n        <Item onClick={this.onClickAddZoom} tooltip=\"zoom out\">\n          {Icon(IconName.PLUS)}\n        </Item>\n      </ViewerRoot>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Icon } from '../../utils';\n\nexport type TopicContextMenuItemConfig = {\n  icon?: string;\n  label?: string;\n  shortcut?: string;\n  opType?: string;\n  rootCanUse?: boolean;\n  hotKey?: string;\n};\n\nconst items: TopicContextMenuItemConfig[] = [\n  {\n    icon: 'edit',\n    label: 'edit',\n    shortcut: 'Space',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_CONTENT\n  },\n  {\n    icon: 'add-sibling',\n    label: 'add sibling',\n    shortcut: 'Enter',\n    opType: OpType.ADD_SIBLING\n  },\n  {\n    icon: 'add-child',\n    label: 'add child',\n    shortcut: 'Tab',\n    rootCanUse: true,\n    opType: OpType.ADD_CHILD\n  },\n  {\n    icon: 'notes',\n    label: 'edit notes',\n    shortcut: 'Alt + D',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_DESC\n  },\n  {\n    icon: 'delete-node',\n    label: 'delete node',\n    shortcut: 'Del',\n    opType: OpType.DELETE_TOPIC\n  },\n  {\n    icon: 'root',\n    label: 'set as editor root',\n    shortcut: 'Alt + Shift + F',\n    opType: OpType.SET_EDITOR_ROOT\n  }\n];\n\nexport function customizeTopicContextMenu(props) {\n  const { topicKey, model, controller } = props;\n  const isRoot = topicKey === model.editorRootTopicKey;\n  function onClickItem(item) {\n    return function(e) {\n      item.opType &&\n        controller.run('operation', { ...props, opType: item.opType });\n    };\n  }\n  return items.map(item =>\n    isRoot && !item.rootCanUse ? null : (\n      <MenuItem\n        key={item.label}\n        icon={Icon(item.icon)}\n        text={item.label}\n        labelElement={<kbd>{item.shortcut}</kbd>}\n        onClick={onClickItem(item)}\n      />\n    )\n  );\n}\n","import { BlockType, FocusMode, OpType } from '@blink-mind/core';\nimport { Drawer } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { cancelEvent, Icon } from '../../utils';\nconst DescEditorWrapper = styled.div`\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n`;\n\nexport function renderDrawer(props) {\n  const { controller, model, topicKey } = props;\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    const onDescEditorClose = e => {\n      e.stopPropagation();\n      const key = `topic-desc-data-${topicKey}`;\n      const descData = controller.run('deleteTempValue', { key });\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      });\n    };\n    const descEditor = controller.run('renderTopicDescEditor', props);\n    return (\n      <Drawer\n        title=\"Edit Notes\"\n        icon={Icon('note')}\n        isOpen\n        hasBackdrop\n        backdropProps={{ onMouseDown: cancelEvent }}\n        isCloseButtonShown={false}\n        onClose={onDescEditorClose}\n        size=\"70%\"\n      >\n        <DescEditorWrapper>{descEditor}</DescEditorWrapper>\n      </Drawer>\n    );\n  }\n}\n","import * as React from 'react';\nimport { ThemeProvider } from 'styled-components';\n\nexport default function Theme({ theme, children }) {\n  return (\n    //@ts-ignore\n    <ThemeProvider theme={theme}>\n      <React.Fragment>{children}</React.Fragment>\n    </ThemeProvider>\n  );\n}\n","import { BlockType, FocusMode, OpType } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { SaveRef } from '../../components/common';\nimport { linksRefKey, RefKey } from '../../utils';\nimport { EditorRootBreadcrumbs } from './components/editor-root-breadcrumbs';\nimport { MindDragScrollWidget } from './components/mind-drag-scroll-widget';\nimport { Modals } from './components/modals';\nimport { RootSubLinks } from './components/root-sublinks';\nimport { RootWidget } from './components/root-widget';\nimport { StyleEditor } from './components/style-editor';\nimport { TopicCollapseIcon } from './components/topic-collapse-icon';\nimport { TopicContent } from './components/topic-content';\nimport { TopicContentWidget } from './components/topic-content-widget';\nimport { TopicContextMenu } from './components/topic-context-menu';\nimport { TopicDesc } from './components/topic-desc';\nimport { TopicHighlight } from './components/topic-highlight';\nimport { TopicSubLinks } from './components/topic-sub-links';\nimport { TopicWidget } from './components/topic-widget';\nimport { ViewPortViewer } from './components/view-port-util';\nimport { customizeTopicContextMenu } from './context-menus';\nimport { renderDrawer } from './drawer';\nimport Theme from './theme';\nconst log = debug('plugin:rendering');\n\nexport function RenderingPlugin() {\n  const DiagramRoot = styled.div`\n    width: 100%;\n    height: 100%;\n    background: ${props => props.theme.background};\n    position: relative;\n  `;\n  return {\n    renderDiagram(props) {\n      const { model, controller } = props;\n      return (\n        <SaveRef>\n          {(saveRef, getRef) => {\n            const widgetProps = {\n              ...props,\n              saveRef,\n              getRef\n            };\n            log('renderDiagram', model);\n            return (\n              <Theme theme={model.config.theme}>\n                <DiagramRoot ref={saveRef(RefKey.DIAGRAM_ROOT_KEY)}>\n                  <MindDragScrollWidget {...widgetProps} />\n                  {controller.run('renderDiagramCustomize', widgetProps)}\n                </DiagramRoot>\n              </Theme>\n            );\n          }}\n        </SaveRef>\n      );\n    },\n    renderDrawer,\n\n    renderDiagramCustomize(props) {\n      const { controller, model } = props;\n      const nProps = {\n        ...props,\n        topicKey: model.focusKey\n      };\n      const breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps);\n      const styleEditor = controller.run('renderStyleEditor', nProps);\n      const modals = controller.run('renderModals', nProps);\n      const drawer = controller.run('renderDrawer', nProps);\n      const viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, styleEditor, modals, drawer, viewportViewer];\n    },\n\n    renderEditorRootBreadcrumbs(props) {\n      return <EditorRootBreadcrumbs key=\"EditorRootBreadcrumbs\" {...props} />;\n    },\n\n    renderModals(props) {\n      return <Modals key=\"modals\" {...props} />;\n    },\n\n    renderModal(props) {\n      return null;\n    },\n\n    getActiveModalProps(props) {\n      return null;\n    },\n\n    renderDoc({ children }) {\n      return children;\n    },\n\n    renderRootWidget(props) {\n      return <RootWidget {...props} />;\n    },\n\n    renderTopicWidget(props) {\n      return <TopicWidget {...props} />;\n    },\n\n    renderTopicContent(props) {\n      return <TopicContentWidget {...props} />;\n    },\n\n    renderTopicContextMenu(props) {\n      return <TopicContextMenu {...props} />;\n    },\n\n    customizeTopicContextMenu,\n\n    renderTopicCollapseIcon(props) {\n      return <TopicCollapseIcon {...props} />;\n    },\n\n    renderTopicBlocks(props) {\n      const { model, topicKey, controller } = props;\n      const topic = model.getTopic(topicKey);\n      const blocks = topic.blocks;\n      const res = [];\n      let i = 0;\n      blocks.forEach(block => {\n        const b = controller.run('renderTopicBlock', {\n          ...props,\n          block,\n          blockKey: `block-${i}`\n        });\n        if (b) {\n          res.push(<React.Fragment key={`block-${i}`}>{b}</React.Fragment>);\n          i++;\n        }\n      });\n      return res;\n    },\n\n    renderTopicBlock(props) {\n      const { controller, block } = props;\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n        default:\n          break;\n      }\n      return null;\n    },\n\n    renderTopicBlockContent(props) {\n      return <TopicContent {...props} />;\n    },\n\n    renderTopicBlockDesc(props) {\n      return <TopicDesc {...props} />;\n    },\n\n    renderSubLinks(props) {\n      const { saveRef, topicKey, model } = props;\n      const topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return <TopicSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderRootSubLinks(props) {\n      const { saveRef, topicKey, model } = props;\n      const topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0) return null;\n      return <RootSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderFocusItemHighlight(props) {\n      const { saveRef } = props;\n      return (\n        <TopicHighlight ref={saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)} {...props} />\n      );\n    },\n\n    renderRootWidgetOtherChildren(props) {\n      const { controller } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      props = { ...props, zoomFactor };\n      return (\n        <>\n          {controller.run('renderRootSubLinks', props)}\n          {controller.run('renderFocusItemHighlight', props)}\n          {controller.run('renderDragAndDropEffect', props)}\n        </>\n      );\n    },\n\n    renderStyleEditor(props) {\n      return <StyleEditor key=\"style-editor\" {...props} />;\n    },\n\n    renderViewPortViewer(props) {\n      return <ViewPortViewer key=\"view-port-viewer\" {...props} />;\n    }\n  };\n}\n","import debug from 'debug';\nconst log = debug('plugin:utils');\nexport function UtilsPlugin() {\n  const tempValueMap = new Map();\n  const eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener(props) {\n      const { key, listener } = props;\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n      eventListenerMap.get(key).push(listener);\n    },\n\n    removeTempValueChangeListener(props) {\n      const { key, listener } = props;\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap.get(key).filter(\n          l => l !== listener\n        );\n      }\n    },\n\n    getTempValue(props) {\n      const { key } = props;\n      log('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n\n    setTempValue(props) {\n      const { key, value } = props;\n      log('setTempValue', key);\n      tempValueMap.set(key, value);\n      if (eventListenerMap.has(key)) {\n        const listeners = eventListenerMap.get(key);\n        for (const listener of listeners) {\n          listener(value);\n        }\n      }\n    },\n\n    deleteTempValue(props) {\n      const { key } = props;\n      log('deleteTempValue', key);\n      const value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n","import { RenderingPlugin } from './rendering';\nimport { UtilsPlugin } from './utils';\n\nexport function ReactPlugin(options = {}) {\n  return [RenderingPlugin(), UtilsPlugin()];\n}\n","import { OpType, TopicStyle, TopicVisualLevel } from '@blink-mind/core';\nimport debug from 'debug';\nimport { isEqual } from 'lodash';\n\nconst log = debug('plugin:StylePlugin');\n\nexport function StylePlugin() {\n  const colorMap = new Map();\n  let colorIndex = 0;\n  return {\n    getTopicStyle(props): TopicStyle {\n      const { controller } = props;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n\n    getTopicContentStyle(props): TopicStyle {\n      const { topicKey, model, controller } = props;\n      log('getTopicContentStyle:', topicKey, model);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        themeStyle = theme.primaryTopic;\n      else themeStyle = theme.normalTopic;\n\n      themeStyle = { ...theme.contentStyle, ...themeStyle.contentStyle };\n\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        themeStyle = {\n          ...themeStyle,\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: {\n            ...themeStyle.subLinkStyle,\n            lineColor: randomColor\n          }\n        };\n      }\n      const topic = model.getTopic(topicKey);\n      if (!topic.style) {\n        return themeStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...themeStyle,\n        ...customStyle.contentStyle\n      };\n    },\n\n    getLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      log('getLinkStyle', topicKey);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let linkStyle = theme.linkStyle;\n      let presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        presetStyle = theme.rootTopic.linkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        presetStyle = theme.primaryTopic.linkStyle;\n      else presetStyle = theme.normalTopic.linkStyle;\n\n      linkStyle = { ...linkStyle, ...presetStyle };\n\n      const topic = model.getTopic(topicKey);\n      // 获取父节点的color\n      // if (theme.randomColor) {\n      //   const randomColor = controller.run('getRandomColor', {\n      //     ...props,\n      //     topicKey:\n      //       topic.parentKey !== model.editorRootTopicKey\n      //         ? topic.parentKey\n      //         : topicKey\n      //   });\n      //   log(randomColor);\n      //   linkStyle = {\n      //     ...linkStyle,\n      //     lineColor: randomColor\n      //   };\n      // }\n\n      if (topic.parentKey != null) {\n        const parentSubLinkStyle = controller.run('getSubLinkStyle', {\n          ...props,\n          topicKey: topic.parentKey\n        });\n\n        linkStyle = {\n          ...linkStyle,\n          ...parentSubLinkStyle\n        };\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...linkStyle,\n        ...customStyle.linkStyle\n      };\n    },\n\n    getSubLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      log('getLinkStyle', topicKey);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let subLinkStyle = theme.linkStyle;\n      let presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        presetStyle = theme.rootTopic.subLinkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        presetStyle = theme.primaryTopic.subLinkStyle;\n      else presetStyle = theme.normalTopic.subLinkStyle;\n\n      subLinkStyle = { ...subLinkStyle, ...presetStyle };\n\n      const topic = model.getTopic(topicKey);\n      // 获取父节点的color\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        log(randomColor);\n        subLinkStyle = {\n          ...subLinkStyle,\n          lineColor: randomColor\n        };\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      const res = {\n        ...subLinkStyle,\n        ...customStyle.subLinkStyle\n      };\n      // if (res.lineRadius == null) res.lineRadius = 5;\n      return res;\n    },\n\n    setTopicContentStyle(props) {\n      const { topicKey, controller, style, model } = props;\n      const topic = model.getTopic(topicKey);\n      const topicStyle = topic.style;\n      const styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n      const newStyleObj = {\n        ...styleObj,\n        contentStyle: {\n          ...styleObj.contentStyle,\n          ...style\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    setLinkStyle(props) {\n      const { topicKey, controller, linkStyle, model } = props;\n      const topic = model.getTopic(topicKey);\n      const style = topic.style;\n      const styleObj = style ? JSON.parse(style) : {};\n      const newStyleObj = {\n        ...styleObj,\n        linkStyle: {\n          ...styleObj.linkStyle,\n          ...linkStyle\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    setSubLinkStyle(props) {\n      const { topicKey, controller, subLinkStyle, model } = props;\n      const topic = model.getTopic(topicKey);\n      const style = topic.style;\n      const styleObj = style ? JSON.parse(style) : {};\n      const newStyleObj = {\n        ...styleObj,\n        subLinkStyle: {\n          ...styleObj.subLinkStyle,\n          ...subLinkStyle\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    getTopicThemeStyle(props): TopicStyle {\n      const { topicKey, model } = props;\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n\n    getRandomColor(props) {\n      const { topicKey } = props;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      const colors = [\n        '#00CC99',\n        '#FFEE88',\n        '#A167A5',\n        '#E5F993',\n        '#F5C396',\n        '#DB995A',\n        '#83BCFF',\n        '#ED7B84',\n        '#739E82',\n        '#D3BCC0',\n        '#FFA0FD',\n        '#EFD3D7',\n        '#C6878F'\n      ];\n      const color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log('getRandomColor', topicKey, color);\n      return color;\n    },\n\n    clearAllCustomStyle(props) {\n      const { model, controller } = props;\n      const newModel = model.withMutations(model => {\n        model.topics.keySeq().forEach(key => {\n          model.setIn(['topics', key, 'style'], null);\n        });\n      });\n      controller.change(newModel);\n    }\n  };\n}\n","import SimpleTextEditorPlugin from '@blink-mind/plugin-simple-text-editor';\nimport { DragAndDrop } from './drag-and-drop';\nimport { EventPlugin } from './event';\nimport { HotKeyPlugin } from './hotkey';\nimport { LayoutPlugin } from './layout';\nimport { OperationPlugin } from './operation';\nimport { ReactPlugin } from './react';\nimport { StylePlugin } from './style';\n\nexport function DefaultPlugin() {\n  return [\n    ReactPlugin(),\n    LayoutPlugin(),\n    OperationPlugin(),\n    StylePlugin(),\n    EventPlugin(),\n    HotKeyPlugin(),\n    DragAndDrop(),\n    SimpleTextEditorPlugin()\n  ];\n}\n","import {\n  Controller,\n  FocusMode,\n  Model,\n  OnChangeFunction\n} from '@blink-mind/core';\n// TODO\nimport '@blink-mind/icons';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport debug from 'debug';\nimport memoizeOne from 'memoize-one';\nimport * as React from 'react';\nimport { DefaultPlugin } from '../plugins';\nimport './diagram.css';\nconst log = debug('node:Diagram');\n\ninterface Props {\n  model: Model;\n  onChange: OnChangeFunction;\n  commands?: any;\n  plugins?: any;\n}\n\n@HotkeysTarget\nexport class Diagram extends React.Component<Props> {\n  controller: Controller;\n\n  getDiagramProps() {\n    return this.diagramProps;\n  }\n\n  diagramProps;\n\n  resolveController = memoizeOne((plugins = [], commands, TheDefaultPlugin) => {\n    const defaultPlugin = TheDefaultPlugin();\n    this.controller = new Controller({\n      plugins: [plugins, defaultPlugin],\n      commands,\n      construct: false,\n      onChange: this.props.onChange\n    });\n    this.controller.run('onConstruct');\n  });\n\n  renderHotkeys() {\n    const { controller, model } = this.diagramProps;\n    if (\n      model.focusMode === FocusMode.NORMAL ||\n      model.focusMode === FocusMode.SHOW_POPUP\n    ) {\n      const hotKeys = controller.run('customizeHotKeys', this.diagramProps);\n      if (hotKeys === null) return null;\n      if (!(hotKeys instanceof Map)) {\n        throw new TypeError('customizeHotKeys must return a Map');\n      }\n      const children = [];\n      hotKeys.forEach((v, k) => {\n        children.push(<Hotkey key={k} {...v} global />);\n      });\n      return <Hotkeys>{children}</Hotkeys>;\n    }\n    return <Hotkeys/>;\n  }\n\n  render() {\n    const { commands, plugins, model } = this.props;\n    this.resolveController(plugins, commands, DefaultPlugin);\n    this.diagramProps = {\n      ...this.props,\n      controller: this.controller,\n      model,\n      diagram: this\n    };\n    return this.controller.run('renderDiagram', this.diagramProps);\n  }\n}\n"],"names":["React.PureComponent","React.createElement","React.Component","log","borderWidthItems","Icon","cancelEvent","TopicContent","React.Fragment"],"mappings":"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"}